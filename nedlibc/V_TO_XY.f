	SUBROUTINE V_TO_XY(E,XX,YY)
C	convert unit vector into x,y coordinates
	REAL*4 E(3)
	REAL XX,YY
	REAL*8 TWOPI,PI,PIOVER2,PIOVER4
	PARAMETER (TWOPI = 6.28318530717958D0)
	PARAMETER (PI = 3.14159265358979D0)
	PARAMETER (PIOVER2 = 1.5707963267949D0)
	PARAMETER (PIOVER4 = 0.785398163397448D0)
	CALL NORM(E)
	Z = ABS(E(3))
	X = 0.
	IF (E(2).NE.0. .OR. E(1).NE.0.) X = ATAN2(E(2),E(1))
	IF (X.LT.0.) X=X+TWOPI
	N = X/PIOVER2
	IF (N.GT.3) N=3
	IF (Z.LE.(2./3.)) THEN
	  YY = E(3)
	  XX = X
	ELSE
	  Y = (4.-SQRT(12.*(E(1)**2+E(2)**2)/(1+Z)))/3.
	  YY = SIGN(Y,E(3))
	  XX = X*(2.-1.5*Y)+(N+0.5)*PIOVER2*(1.5*Y-1.)
	ENDIF
	RETURN
	END
