	FUNCTION SOLARFIT(WVL)
C	gives Solar spectrum at 1 AU in Janskies for wavelength in microns
	REAL WVL	! wavelength in microns
	REAL*8 HCK,X,TBB,LAM,PHLAM,SL,SP,NB
	PARAMETER (HCK=1.4387752D0,TBB=5777.D0)
	PARAMETER (NP=57)
	REAL LT(NP) / 965., 1060., 1165., 1280., 1412., 1548., 1698.,
	1	1870., 2061., 2270., 2505., 2765., 3050., 3360., 3697.,
	2	4080., 4500., 4960., 5470., 6040., 6670., 7360., 8120.,
	3	8960., 9761., 10775., 11875., 13100., 14450., 15728.,
	4	17350., 19150., 21150., 23350., 25750., 28400., 31068.,
	5	34300., 37800., 41600., 45800., 50500., 55700., 61303.,
	6	67600., 74400., 82000., 90400., 97600., 200000., 400000.,
	7	600000., 800000., 1000000., 1200000., 1400000., 1600000./
	REAL LPT(NP) /6.967331, 7.624355, 8.548452, 8.936091, 9.187331,
	1	9.986671, 10.933140, 11.487271, 12.200314, 12.413113,
	2	12.306274, 12.675776, 12.919943, 12.926085, 12.901201,
	3	12.999663, 13.059056, 13.064871, 13.053810, 13.050318,
	4	13.034097, 13.024272, 13.018996, 13.017098, 13.023745,
	5	13.030026, 13.043204, 13.061952, 13.082721, 13.098722,
	6	13.097735, 13.080925, 13.071199, 13.056686, 13.042140,
	7	13.034956, 13.025371, 13.015338, 13.005740, 12.996372,
	8	12.971069, 12.971353, 12.971633, 12.971406, 12.968663,
	9	12.964609, 12.960863, 12.957308, 12.954759, 12.937431,
	1	12.925417, 12.918729, 12.913915, 12.910128, 12.906994,
	2	12.904307, 12.901968/
	AA = 1.E4*WVL
	IF (AA.LT.LT(1)) THEN
	  SOLARFIT = 0
	  RETURN
	ENDIF
	IF (AA.GE.LT(NP)) THEN
	  I=NP
	ELSE
	  I = 2
	  DO WHILE (LT(I).LT.AA)
	    I = I+1
	  ENDDO
	ENDIF
	X = LOG(AA/LT(I-1))/LOG(LT(I)/LT(I-1))
	PT = LPT(I-1)+X*(LPT(I)-LPT(I-1))
C	write (*,*) i,x,pt
	X = 10000*HCK/(WVL*TBB)
	IF (X.LT.0.001) THEN
	  NB = X+X**2/2+X**3/6
	ELSE
	  NB = EXP(X)-1
	ENDIF
	PHLAM = (10.**PT)*(X**4)/NB
C	photons/octave = AA*photons/angstrom \propto F_nu
	SOLARFIT = 0.000664685649*AA*PHLAM
	RETURN
	END

